{% extends "base.html" %}
{% load static %}

{% block title %}Project Form | Admin{% endblock %}

{% block content %}

<section class="container" style="margin-top: 80px;">
  <h1>
    {% if form.instance.pk %}
      Edit Project
    {% else %}
      Add New Project
    {% endif %}
  </h1>
</section>

<section class="container" style="margin-top: 40px; max-width: 900px;">

  <form method="post" enctype="multipart/form-data" class="card">
    {% csrf_token %}

    <!-- =======================
         PROJECT MAIN FORM
    ======================== -->
    {% for field in form %}
      <div class="form-group">
        <label for="{{ field.id_for_label }}">
          {{ field.label }}
        </label>

        {{ field }}

        {% if field.errors %}
          <div class="form-error">
            {{ field.errors }}
          </div>
        {% endif %}
      </div>
    {% endfor %}

    <hr style="margin:40px 0;">

    <!-- =======================
         PROJECT MEDIA FORMSET
    ======================== -->
    <h3>Project Media</h3>

    {{ formset.management_form }}

    {% for media_form in formset %}
      <div class="card" style="margin-bottom:20px; padding:15px;">

        {% for field in media_form.visible_fields %}
          <div class="form-group">
            <label>{{ field.label }}</label>
            {{ field }}
            {% if field.errors %}
              <div class="form-error">{{ field.errors }}</div>
            {% endif %}
          </div>
        {% endfor %}

        {% if media_form.instance.pk %}
          <div class="form-group">
            {{ media_form.DELETE }} Delete this media
          </div>
        {% endif %}
      </div>
    {% endfor %}

    <!-- =======================
         ACTIONS
    ======================== -->
    <div style="margin-top: 30px; display: flex; gap: 15px;">
      <button type="submit" class="btn">
        Save Project
      </button>

      <a href="{% url 'greenshan:manage_list' %}" class="btn ghost">
        Cancel
      </a>
    </div>

  </form>

</section>

{% endblock %}
