{% extends "base.html" %}
{% block title %}{{ project.title }} — GreenShan{% endblock %}
{% block content %}
<section class="section project-hero" data-animate>
  <div class="container">
    <h1>{{ project.title }}</h1>
    <p class="meta">{{ project.client }} • {{ project.project_date|date:"Y" }}</p>
    {% if project.cover %}<img src="{{ project.cover.url }}" alt="{{ project.title }}" class="hero-profile-img" loading="lazy">{% endif %}
  </div>
</section>

<section class="section project-body">
  <div class="container">
    <h2>Project Description</h2>
    <div class="project-description">{{ project.description|linebreaks }}</div>
    {% if project.experience_notes %}
      <h3>Experience</h3>
      <div class="project-experience">{{ project.experience_notes|linebreaks }}</div>
    {% endif %}

    <h3 style="margin-top:18px">Media</h3>
    <div class="gallery-grid">
      {% for m in project.media.all %}
        <figure class="gallery-item">
          {% if m.is_image %}
            <img src="{{ m.file.url }}" alt="{{ m.caption|default:project.title }}" loading="lazy" class="gallery-img">
          {% elif m.is_video %}
            <video controls preload="metadata" style="max-width:100%;">
              <source src="{{ m.file.url }}">
              Your browser doesn't support the video element.
            </video>
          {% elif m.is_audio %}
            <audio controls style="width:100%;">
              <source src="{{ m.file.url }}">
              Your browser doesn't support the audio element.
            </audio>
          {% elif m.is_document %}
            <a href="{{ m.file.url }}" target="_blank" rel="noopener">{{ m.filename }}</a>
            {% if m.filename|lower.endswith:".pdf" %}
              <iframe src="{{ m.file.url }}" style="width:100%;height:480px;border:0;margin-top:10px;"></iframe>
            {% endif %}
          {% else %}
            <a href="{{ m.file.url }}" target="_blank" rel="noopener">{{ m.filename }}</a>
          {% endif %}
          {% if m.caption %}<figcaption>{{ m.caption }}</figcaption>{% endif %}
        </figure>
      {% empty %}
        <p class="muted">No media added for this project.</p>
      {% endfor %}
    </div>

    <div style="margin-top:20px">
      <a class="btn ghost" href="{% url 'portfolio_app:portfolio_list' %}">← Back to Portfolio</a>
    </div>
  </div>
</section>
{% endblock %}
